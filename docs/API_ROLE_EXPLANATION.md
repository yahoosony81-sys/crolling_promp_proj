# API 역할 설명 및 확인 필요 이유

이 문서는 각 API가 무엇을 하는지, 왜 확인해야 하는지를 쉽게 설명합니다.

## 🤔 왜 API를 확인해야 하나요?

### 1. **사이트가 제대로 작동하는지 확인하기 위해**

웹사이트는 여러 부분으로 구성되어 있습니다:
- **프론트엔드**: 사용자가 보는 화면 (버튼, 메뉴 등)
- **백엔드**: 실제 데이터를 처리하는 부분 (API)

예를 들어:
- 사용자가 "프롬프트 보기" 버튼을 클릭
- → 프론트엔드가 API를 호출
- → API가 데이터베이스에서 데이터를 가져옴
- → 화면에 표시

**API가 작동하지 않으면 버튼을 눌러도 아무것도 안 보입니다!**

### 2. **문제를 빠르게 찾기 위해**

사용자가 "프롬프트가 안 보여요!"라고 하면:
- 화면 문제인지? → 프론트엔드 확인
- 데이터 문제인지? → API 확인
- 데이터베이스 문제인지? → 데이터베이스 확인

**API를 확인하면 문제가 어디에 있는지 빠르게 알 수 있습니다.**

### 3. **새로운 기능을 추가하기 전에 확인하기 위해**

새로운 기능을 만들기 전에:
- 기존 API가 잘 작동하는지 확인
- 데이터가 제대로 저장되는지 확인
- 연결이 제대로 되는지 확인

**기존 기능이 작동해야 새로운 기능도 작동합니다.**

---

## 📋 각 API의 역할

### 1. 🕷️ 크롤링 API (`/api/crawl/run`)

#### 역할: **인터넷에서 트렌드 정보를 자동으로 수집**

**구체적으로 하는 일:**
1. 네이버 쇼핑, 유튜브, 블로그 등에서 트렌드 키워드를 찾음
2. 각 키워드로 상품, 영상, 글 등을 수집함
3. 수집한 정보를 요약하고 정리함
4. 데이터베이스에 저장함

**예시:**
- "아이폰 15"가 인기 키워드라고 감지
- → 쇼핑몰에서 아이폰 15 관련 상품 정보 수집
- → 유튜브에서 아이폰 15 리뷰 영상 수집
- → 블로그에서 아이폰 15 관련 글 수집
- → 모든 정보를 정리해서 데이터베이스에 저장

**왜 확인해야 하나요?**
- ✅ 크롤링이 작동하지 않으면 → 트렌드 데이터가 없음 → 사용자에게 보여줄 내용이 없음
- ✅ 크롤링이 느리면 → 데이터 수집이 오래 걸림 → 사용자가 기다려야 함
- ✅ 크롤링이 에러나면 → 데이터가 잘못 저장됨 → 잘못된 정보가 표시됨

**확인 방법:**
- Postman으로 API 호출
- 성공하면 → 데이터베이스에 새로운 트렌드 패키지가 생성됨
- 실패하면 → 에러 메시지 확인

---

### 2. 📝 프롬프트 API (`/api/prompts`)

#### 역할: **프롬프트 템플릿을 가져와서 사용자에게 보여줌**

**구체적으로 하는 일:**
1. 데이터베이스에서 프롬프트 목록을 가져옴
2. 카테고리별로 필터링 (상품, 부동산, 주식 등)
3. 페이지네이션 처리 (한 번에 50개씩 보여줌)
4. 사용자에게 JSON 형식으로 전달

**예시:**
- 사용자가 "상품 분석 프롬프트"를 보고 싶어함
- → API가 데이터베이스에서 상품 카테고리의 프롬프트를 찾음
- → 사용자에게 목록을 보여줌

**왜 확인해야 하나요?**
- ✅ 프롬프트가 안 보이면 → 사용자가 프롬프트를 사용할 수 없음
- ✅ 프롬프트가 잘못된 카테고리로 표시되면 → 사용자가 헷갈림
- ✅ 프롬프트가 너무 많아서 느리면 → 사용자가 기다려야 함

**확인 방법:**
- 브라우저에서 `http://localhost:3000/api/prompts` 접속
- JSON 형식으로 프롬프트 목록이 보이면 → 정상 작동
- 에러가 나면 → 데이터베이스 연결 문제일 수 있음

---

### 3. 📊 트렌드 API (`/api/trends`)

#### 역할: **수집한 트렌드 데이터를 사용자에게 보여줌**

**구체적으로 하는 일:**
1. 데이터베이스에서 트렌드 패키지 목록을 가져옴
2. 카테고리별, 주차별로 필터링
3. 인증 및 구독 확인 (유료 서비스)
4. 사용자에게 트렌드 정보 전달

**예시:**
- 사용자가 "이번 주 상품 트렌드"를 보고 싶어함
- → API가 데이터베이스에서 이번 주 상품 트렌드를 찾음
- → 사용자가 구독 중인지 확인
- → 구독 중이면 트렌드 정보를 보여줌

**왜 확인해야 하나요?**
- ✅ 트렌드가 안 보이면 → 사용자가 트렌드를 확인할 수 없음 → 구독 취소할 수 있음
- ✅ 트렌드가 오래된 것이면 → 사용자가 최신 정보를 원하는데 오래된 정보를 봄
- ✅ 구독 확인이 안 되면 → 무료로 유료 콘텐츠를 볼 수 있음 → 수익 손실

**확인 방법:**
- 로그인 후 브라우저에서 `http://localhost:3000/api/trends` 접속
- JSON 형식으로 트렌드 목록이 보이면 → 정상 작동
- 403 에러가 나면 → 구독이 필요함
- 401 에러가 나면 → 로그인이 필요함

---

### 4. 👤 계정 API (`/api/account/usage`)

#### 역할: **사용자가 어떤 프롬프트를 사용했는지 기록을 보여줌**

**구체적으로 하는 일:**
1. 데이터베이스에서 사용자의 이용 기록을 찾음
2. 어떤 프롬프트를 언제 사용했는지 조회
3. 어떤 트렌드 패키지를 사용했는지 조회
4. 페이지네이션 처리 (한 번에 20개씩 보여줌)

**예시:**
- 사용자가 "내가 사용한 프롬프트 목록"을 보고 싶어함
- → API가 데이터베이스에서 해당 사용자의 이용 기록을 찾음
- → 사용자에게 목록을 보여줌

**왜 확인해야 하나요?**
- ✅ 이용 기록이 안 보이면 → 사용자가 자신의 활동을 확인할 수 없음
- ✅ 이용 기록이 잘못 저장되면 → 사용자가 사용하지 않은 프롬프트가 기록됨
- ✅ 이용 기록이 너무 많아서 느리면 → 사용자가 기다려야 함

**확인 방법:**
- 로그인 후 브라우저에서 `http://localhost:3000/api/account/usage` 접속
- JSON 형식으로 이용 기록이 보이면 → 정상 작동
- 401 에러가 나면 → 로그인이 필요함

---

## 🔄 전체 흐름 이해하기

### 시나리오: 사용자가 트렌드 프롬프트를 사용하는 과정

1. **크롤링 API** (`/api/crawl/run`)
   - 매주 자동으로 실행됨
   - 인터넷에서 트렌드 정보 수집
   - 데이터베이스에 저장
   - **결과**: 새로운 트렌드 패키지 생성

2. **트렌드 API** (`/api/trends`)
   - 사용자가 "트렌드 보기" 클릭
   - API가 데이터베이스에서 트렌드 목록 가져옴
   - 사용자에게 표시
   - **결과**: 사용자가 트렌드 목록을 봄

3. **프롬프트 API** (`/api/prompts`)
   - 사용자가 특정 트렌드의 프롬프트를 선택
   - API가 해당 프롬프트 정보를 가져옴
   - 사용자에게 표시
   - **결과**: 사용자가 프롬프트를 사용함

4. **계정 API** (`/api/account/usage`)
   - 사용자가 프롬프트를 사용함
   - 시스템이 이용 기록을 데이터베이스에 저장
   - 사용자가 "내 이용 기록" 클릭
   - API가 이용 기록을 가져옴
   - **결과**: 사용자가 자신의 활동을 확인함

---

## ✅ 확인해야 하는 이유 요약

### 1. **사용자 경험 확인**
- API가 작동하지 않으면 → 사용자가 원하는 정보를 볼 수 없음
- API가 느리면 → 사용자가 기다려야 함
- API가 에러나면 → 사용자가 불만을 가짐

### 2. **비즈니스 확인**
- 트렌드 API가 작동하지 않으면 → 구독자들이 서비스를 사용할 수 없음 → 수익 손실
- 프롬프트 API가 작동하지 않으면 → 핵심 기능이 작동하지 않음 → 사용자 이탈
- 크롤링 API가 작동하지 않으면 → 새로운 콘텐츠가 없음 → 사용자들이 지루해함

### 3. **문제 해결**
- 사용자가 "안 돼요!"라고 하면 → 어느 API가 문제인지 확인
- 새 기능을 추가하기 전에 → 기존 API가 작동하는지 확인
- 배포하기 전에 → 모든 API가 정상 작동하는지 확인

---

## 🎯 실제 확인 시나리오

### 시나리오 1: 사용자가 "프롬프트가 안 보여요"라고 함

**확인 순서:**
1. 프롬프트 API 확인 (`/api/prompts`)
   - 작동하면 → 프론트엔드 문제
   - 작동 안 하면 → 데이터베이스 문제 또는 API 코드 문제

2. 데이터베이스 확인
   - 프롬프트 데이터가 있는지 확인
   - 없으면 → 데이터 추가 필요

3. 프론트엔드 확인
   - API는 작동하는데 화면에 안 보이면 → 프론트엔드 코드 문제

### 시나리오 2: 새로운 트렌드가 안 보임

**확인 순서:**
1. 크롤링 API 확인 (`/api/crawl/run`)
   - 실행했는지 확인
   - 성공했는지 확인

2. 트렌드 API 확인 (`/api/trends`)
   - 새로운 트렌드가 데이터베이스에 있는지 확인
   - API가 제대로 가져오는지 확인

3. 프론트엔드 확인
   - API는 작동하는데 화면에 안 보이면 → 프론트엔드 코드 문제

---

## 💡 비유로 이해하기

### API = 레스토랑의 주방

- **프론트엔드** = 웨이터 (고객과 직접 대화)
- **API** = 주방 (음식을 만듦)
- **데이터베이스** = 냉장고 (재료 저장)

**시나리오:**
- 고객이 "파스타 주세요"라고 주문
- 웨이터가 주방에 주문 전달
- 주방이 냉장고에서 재료를 가져와서 요리
- 웨이터가 고객에게 음식 전달

**문제 상황:**
- 주방(API)이 작동하지 않으면 → 음식이 안 나옴
- 냉장고(데이터베이스)에 재료가 없으면 → 음식을 만들 수 없음
- 웨이터(프론트엔드)가 주문을 잘못 전달하면 → 잘못된 음식이 나옴

**확인하는 이유:**
- 주방이 제대로 작동하는지 확인
- 냉장고에 재료가 있는지 확인
- 웨이터가 제대로 일하는지 확인

---

## 📝 체크리스트

### 매일 확인할 것
- [ ] 프롬프트 API 작동 확인 (사용자가 가장 많이 사용)
- [ ] 트렌드 API 작동 확인 (구독자들이 사용)

### 주간 확인할 것
- [ ] 크롤링 API 실행 확인 (새로운 트렌드 수집)
- [ ] 계정 API 작동 확인 (이용 기록 확인)

### 배포 전 확인할 것
- [ ] 모든 API 작동 확인
- [ ] 에러 없이 작동하는지 확인
- [ ] 속도가 적절한지 확인

---

**요약: API를 확인하는 이유는 사이트가 제대로 작동하는지, 사용자가 원하는 정보를 볼 수 있는지 확인하기 위해서입니다!**

